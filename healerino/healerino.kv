#:import FadeTransition kivy.uix.screenmanager.FadeTransition

<FightWidget>:
    enemy: enemy_id
    party: party_id
    # player: player_id

    BoxLayout:
        orientation: 'vertical'
        size: root.size
        pos: root.pos

        Enemy:
            id: enemy_id
            size_hint_y: None

        Widget

        Party:
            id: party_id

        Widget

        # Player:
        #     id: player_id

        BoxLayout:
            size_hint_y: None

            Button:
                text: "D"
                on_release: root.enemy.heal(-10)

            Button:
                text: "H"
                on_release: root.enemy.heal(10)

        # Button:
        #     size_hint_y: None
        #     on_release: app.root.current = 'welcome_screen'



    # player: player

    # BoxLayout:
    #     orientation: 'vertical'

    #     Button:
    #         on_release: app.root.current = 'main'

    #     BossWidget

    #     ProgressBar:
    #         id: cooldown_indicator
    #         value: 0

    #     PlayerWidget:
    #         id: player

<HealthBar@ProgressBar>:
    canvas:
        Color:
            rgb: .2, .2, .2

        Rectangle:
            pos: self.x, self.y
            size: self.width, self.height

    canvas.after:
        Color:
            rgb: .8, .8, .8

        Rectangle:
            pos: self.x, self.y
            size: self.width * (self.value / float(self.max)) if self.max else 0, self.height


<Portrait>:
    max_height: '24 dp'

    AnchorLayout:
        pos: root.pos
        size: root.size
        padding: '5 dp'

        BoxLayout:
            orientation: 'horizontal'
            spacing: '5 dp'
            size_hint_y: None
            height: root.max_height

            Image:
                color: 1, 1, 0, 1
                size_hint: None, None
                size: root.max_height, root.max_height

            HealthBar:
                size_hint_y: None
                height: root.max_height
                value: root.health


<Enemy>:


<Party>:
    layout: layout_id

    GridLayout:
        id: layout_id
        cols: 2
        spacing: '10 dp'
        size: root.size
        pos: root.pos


<PartyMember>:
    canvas.before:
        Color:
            rgb: 0, 0, .2

        Rectangle:
            pos: root.pos
            size: root.size


# <PlayerWidget>:

#     SpellWidget:
#         id: spell_slot_1

#     BoxLayout:
#         orientation: 'horizontal'
#         size: root.size

#         Label:
#             text: "Mana:"

#         ProgressBar:
#             id: manabar
#             value: root.mana



# <Portrait@BoxLayout>:
#     orientation: 'vertical'

#     # canvas.before:
#     #     Color:
#     #         rgba: 0, 1, 0, .5
#     #     Rectangle:
#     #         pos: root.pos
#     #         size: root.size

#     # Widget

#     Label:
#         text: "NAME"
#         text_size: root.width, None
#         size_hint: (None, None)
#         size: self.texture_size
#         halign: 'left'
#         valign: 'middle'

#         # canvas.before:
#         #     Color:
#         #         rgba: 1, 1, 1, .2
#         #     Rectangle:
#         #         pos: root.pos
#         #         size: root.size

#     ProgressBar:
#         size_hint_y: None
#         height: '40 dp'
#         value: 100

#     # Widget


# <BossWidget@FloatLayout>:

#     # canvas.before:
#     #     Color:
#     #         rgba: 1, 0, 0, 1
#     #     Rectangle:
#     #         pos: root.pos
#     #         size: root.size

#     Portrait:
#         pos_hint: {'center_x': 0.5, 'top': 1.0}
#         size_hint: (.8, 1)
#         # height: '50 dp'


<WelcomeScreen>:
    name: 'welcome_screen'

    AnchorLayout:
        anchor_x: 'center'

        BoxLayout:
            orientation: 'vertical'
            size_hint: (0.5, 1)
            spacing: 10

            Label:
                size_hint_y: .4
                text: "Healerino"
                valign: 'bottom'
                bold: True
                font_size: 50
                padding: 0, 0

            AnchorLayout:
                anchor_x: 'center'
                size_hint_y: .6

                BoxLayout:
                    size_hint: .5, .5
                    orientation: 'vertical'
                    spacing: 10

                    Button:
                        halign: 'center'
                        valign: 'middle'
                        # text: "Play"
                        on_release: root.manager.current = 'fight_screen'

                    # TODO add Options
                    # Button:
                    #     halign: 'center'
                    #     valign: 'middle'
                    #     text: "Options"


<FightScreen>:
    name: 'fight_screen'

    fight: fight_widget_id

    FightWidget:
        id: fight_widget_id


ScreenManager:
    transition: FadeTransition()

    WelcomeScreen
    FightScreen
